{
  {% for region in regions %}
  "{{region}}": {
    {% for env in envs %}
    "{{env}}":{
      {% set role = 'api_nginx' %}
      "{{role}}": {
        "{{region}}-{{env}}-{{role}}":["summon"],
        "default":["ec2", "logstash", "logs_backup"]
      },
      {% set role = 'consul' %}
      "{{role}}": {
        "{{role}}":["summon"],
        "default":["ec2", "logstash", "logs_backup"]
      },
      {% set role = 'eps' %}
      "{{role}}": {
        "{{role}}":["summon"],
        "default":["ec2", "logstash", "logs_backup"]
      },
      {% set role = 'mongo' %}
      "{{role}}": {
        "{{role}}":["summon"],
        "mongo_backup":["mongo_backup"],
        "dbscript":["service"],
        "default":["ec2", "logstash", "logs_backup"]
      },
      {% set role = 'nat' %}
      "{{role}}": {
        "{{role}}":["summon"],
        "default":["ec2", "logstash", "logs_backup"]
      },
      {% set role = 'pingfederate' %}
      "{{role}}": {
        "{{role}}":["summon"],
        "default":["ec2", "logstash", "logs_backup"]
      },
      {% set role = 'postgres' %}
      "{{role}}": {
        "{{role}}":["summon"],
        "postgres_backup": ["postgres_backup"],
        "dbscript":["service"],
        "default":["ec2", "logstash", "logs_backup"]
      },
      {% set role = 'rabbitmq' %}
      "{{role}}": {
        "{{role}}":["summon"],
        "default":["ec2", "logstash", "logs_backup"]
      },
      {% set role = 'signal-dispatcher' %}
      "{{role}}": {
        "{{role}}":["summon"],
        "default":["ec2", "logstash", "logs_backup"]
      },
      {% set role = 'signal-transmitter' %}
      "{{role}}": {
        "default":["ec2", "logstash", "logs_backup"]
      },
      {% set role = 'tokenservice' %}
      "{{role}}": {
        "{{role}}":["summon"],
        "default":["ec2", "logstash", "logs_backup"]
      },
      {% set role = 'vpn' %}
      "{{role}}": {
        "{{role}}":["summon"],
        "default":["ec2", "logstash", "logs_backup"]
      }
    },
    {% endfor %}
    "infra": {
      {% set role = 'docker_registry' %}
      "{{role}}": {
        "{{role}}":["summon"]
      },
      {% set role = 'nexus' %}
      "{{role}}": {
        "{{role}}":["summon"]
      },
      {% set role = 'signal_recipient' %}
      "{{role}}": {
        "{{role}}":["summon"]
      },
      {% set role = 'jenkins_master' %}
      "{{role}}": {
        "{{role}}":["summon"],
        "ec2_deployer":["ec2_deployer"],
        "elb_deployer":["elb_deployer"],
        "iam_deployer":["iam_deployer"],
        "route53_deployer":["route53_deployer"],
        "default":["ec2", "logstash", "logs_backup"]
      }
    },
    "corp": {
      {% set role = 'es' %}
      "{{role}}": {
        "{{role}}":["summon"]
      },
      {% set role = 'icinga' %}
      "{{role}}": {
        "{{role}}": [ "summon", "ec2_readonly" ]
      },
      {% set role = 'kibana' %}
      "{{role}}": {
        "{{role}}":["summon"],
        "elastalert": [ "summon" ]
      },
      {% set role = 'logstash' %}
      "{{role}}": {
        "{{role}}":["summon"]
      }
    }
  }{%- if not loop.last -%},{%- endif %}
  {% endfor %}
}
